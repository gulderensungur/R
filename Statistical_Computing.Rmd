---
title: "Statistical Computing Final Homework"
author: "Gülderen Sungur"
date: "July 9, 2021"
abstract: 
  "Energy is a concept with a wide definition range. We use and need many types of energy in daily life. As we all know, energy sources are not endless and will run out one day. Therefore, countries take different steps on issues such as energy saving and energy production. In this report, Izmir's electrical energy production and chemical energy consumption datasets are analyzed. According to these analyses, the energy consumption of certain tram/metro stations in Izmir differ from each other. In the Harmandalı Electricity generation dataset, the differences between the planned and produced electrical energy were examined."

keywords: "electiricty energy,energy consumption"

output: 
  html_document:
  toc: true
  toc_depth: 2
  
---




#  Data Visualization
##  Data Description
#### DataSet 1: Energy Consumption for per passenger  
 This dataset is generated by the Izmir Municipality (IBB Acik Veri
Portali https://acikveri.bizizmir.com/dataset/8c7e0e1a-c24c-4ec1-a723-379612facd22/resource/3984882c-d611-4a4a-ad97-39ed2af52dcb/download/enerji-tuketimi-yolcubasina.csv). This data set includes energy consumption per passenger by address in metro and trams. There are 5 columns and 15 rows in total. This data set includes energy consumption per passenger by address in metro and trams. There are 5 columns and 13 rows in total. In the columns, there is information of İzmir metro, Karşıyaka and Konak trams according to dates. It includes data 2020.  
The table below shows the data and summary related to the dataset. 

```{r}
enerji.tuketimi.yolcubasina <- read.csv2("C:/Users/gulde/Downloads/enerji-tuketimi-yolcubasina.csv")
head(enerji.tuketimi.yolcubasina)
summary(enerji.tuketimi.yolcubasina)

```

```{r}

ggplot2::ggplot(data = enerji.tuketimi.yolcubasina, ggplot2::aes(x = AY, y = IZMIR_METRO)) + ggplot2::geom_bar(stat="identity",fill="#00FF84")

ggplot2::ggplot(data = enerji.tuketimi.yolcubasina, ggplot2::aes(x = AY, y = KARSIYAKA_TRAMVAYI)) + ggplot2::geom_bar(stat="identity",fill="#00FF84")

ggplot2::ggplot(data = enerji.tuketimi.yolcubasina, ggplot2::aes(x = AY, y = KONAK_TRAMVAYI )) + ggplot2::geom_bar(stat="identity",fill="#00FF84")

```  

As can be seen in the barcharts shown above, the energy consumed per passenger by the Karşıyaka tram is higher than the others. Karşıyaka tram is followed by İzmir Metro. Konak Tramway had the lowest energy consumption per passenger. For each area, it was observed that the highest energy consumption in the year was observed in the 4th month. The least energy consumption occurred in the 2nd month for each area.   

```{r}

diff(enerji.tuketimi.yolcubasina$KARSIYAKA_TRAMVAYI - enerji.tuketimi.yolcubasina$KONAK_TRAMVAYI)


diff(enerji.tuketimi.yolcubasina$KARSIYAKA_TRAMVAYI - enerji.tuketimi.yolcubasina$IZMIR_METRO)

diff(enerji.tuketimi.yolcubasina$KONAK_TRAMVAYI - enerji.tuketimi.yolcubasina$IZMIR_METRO)
```

The table above shows the differences in energy consumption by location.  


#### DataSet 2: Energy Consumption for per km  
This dataset is generated by the Izmir Municipality (IBB Acik Veri
Portali https://acikveri.bizizmir.com/dataset/8c7e0e1a-c24c-4ec1-a723-379612facd22/resource/45f1ad87-900b-4519-911d-5dc1cc4c917f/download/enerji-tuketimi-cer.csv). This data set includes energy consumption per kilometer by address in metro and trams. There are 5 columns and 13 rows in total. This data set includes energy consumption per kilometers by address in metro and trams In the columns, there is information of İzmir metro, Karşıyaka and Konak trams according to dates. It includes data 2020.  
The table below shows the data and summary related to the dataset. 



```{r}
enerji.tuketimi.cer <- read.csv2("C:/Users/gulde/Downloads/enerji-tuketimi-cer.csv")
head(enerji.tuketimi.cer)
summary(enerji.tuketimi.cer)

```

```{r}

ggplot2::ggplot(data = enerji.tuketimi.cer, ggplot2::aes(x = AY, y = IZMIR_METRO)) + ggplot2::geom_bar(stat="identity",fill="blue")

ggplot2::ggplot(data = enerji.tuketimi.cer, ggplot2::aes(x = AY, y = KARSIYAKA_TRAMVAYI)) + ggplot2::geom_bar(stat="identity",fill="blue")

ggplot2::ggplot(data = enerji.tuketimi.cer, ggplot2::aes(x = AY, y = KONAK_TRAMVAYI )) + ggplot2::geom_bar(stat="identity",fill="blue")

 

```  

According to the graphics shown above, the station with the highest energy consumption per km is Karşıyaka Tramway. It is followed by Konak Tram. The minimum energy consumption per km is in İzmir Metro. Let's take a look at the energy consumption differences by station to see more detailed results.   

```{r}

diff(enerji.tuketimi.cer$KARSIYAKA_TRAMVAYI - enerji.tuketimi.cer$IZMIR_METRO)

diff(enerji.tuketimi.cer$KONAK_TRAMVAYI - enerji.tuketimi.cer$IZMIR_METRO)
```


#### Dataset 3: Harmandalı Electricity Production  

This dataset is generated by the Izmir Municipality (IBB Acik Veri
Portali https://acikveri.bizizmir.com/dataset/6331e364-8128-4f40-b836-1cc57c80adfe/resource/5a23015b-a8fa-465a-ac75-082901e7c718/download/harmandali-enerji-uretimi.csv). This dataset contains data for the first month of 2021 and shows planned energy and produced energy by date. It consists of 31 rows and 3 columns in total.   

```{r}
harmandali.enerji.uretimi <- read.csv("C:/Users/gulde/Downloads/harmandali-enerji-uretimi.csv", sep=";")
head(enerji.tuketimi.cer)

```
```{r}



ggplot2::ggplot(data = harmandali.enerji.uretimi, ggplot2::aes(x = TARIH, y = PLANLANAN_URETIM)) + ggplot2::geom_bar(stat="identity",fill="orange")

ggplot2::ggplot(data = harmandali.enerji.uretimi, ggplot2::aes(x = TARIH, y = GERCEKLESEN_URETIM)) + ggplot2::geom_bar(stat="identity",fill="orange")

 

```  

According to the above barchart, there is no definite increase/decrease order between the planned and realized electricity production. While the planned production is more than the actual production on some dates, it is less on some dates.  

```{r}

diff(harmandali.enerji.uretimi$PLANLANAN_URETIM - harmandali.enerji.uretimi$GERCEKLESEN_URETIM)


```  





# Confidence Interval

#### Dataset 1:

```{r}
mean(enerji.tuketimi.yolcubasina$IZMIR_METRO)

```  
```{r}
sd(enerji.tuketimi.yolcubasina$IZMIR_METRO)

```  
```{r}
norm.interval = function(data, variance, conf.level = 0.95) {
   z = qnorm((1 - conf.level)/2, lower.tail = FALSE)
   xbar = mean(data)
   sdx = sqrt(variance/length(data))
   c(xbar - z * sdx, xbar + z * sdx)
}

norm.interval(enerji.tuketimi.yolcubasina$IZMIR_METRO, variance=var(enerji.tuketimi.yolcubasina$IZMIR_METRO), conf.level = 0.95)

```  

The output on the above is confidenece interval of the data.A point estimate for the true mean energy consumption in the per passanger is 1.0, and we are 95% confident that the true mean is between 0.724204 kWh and 1.275796 kWh. 


```{r}
enerji.tuketimi.yolcubasina.CI <- t.test(enerji.tuketimi.yolcubasina$IZMIR_METRO)$conf.int
enerji.tuketimi.yolcubasina.CI
```  

#### Dataset 2:  

```{r}
mean(enerji.tuketimi.cer$IZMIR_METRO)

```  
```{r}
sd(enerji.tuketimi.cer$IZMIR_METRO)

```  
```{r}
norm.interval = function(data, variance, conf.level = 0.95) {
   z = qnorm((1 - conf.level)/2, lower.tail = FALSE)
   xbar = mean(data)
   sdx = sqrt(variance/length(data))
   c(xbar - z * sdx, xbar + z * sdx)
}

norm.interval(enerji.tuketimi.cer$IZMIR_METRO, variance=var(enerji.tuketimi.cer$IZMIR_METRO), conf.level = 0.95)

```  

The output on the above is confidenece interval of the data. A point estimate for the true mean energy consumption in the per km is 2.136667 kwh, and we are 95% confident that the true mean is between 1.951554 kWh and 2.321779 kWh.


```{r}
enerji.tuketimi.yolcubasina.CI <- t.test(enerji.tuketimi.yolcubasina$IZMIR_METRO)$conf.int
enerji.tuketimi.yolcubasina.CI
``` 



#### Dataset 3:

```{r}
mean(harmandali.enerji.uretimi$GERCEKLESEN_URETIM)

```  
```{r}
sd(harmandali.enerji.uretimi$GERCEKLESEN_URETIM)

```  
```{r}
norm.interval = function(data, variance, conf.level = 0.95) {
   z = qnorm((1 - conf.level)/2, lower.tail = FALSE)
   xbar = mean(data)
   sdx = sqrt(variance/length(data))
   c(xbar - z * sdx, xbar + z * sdx)
}

norm.interval(harmandali.enerji.uretimi$GERCEKLESEN_URETIM, variance=var(harmandali.enerji.uretimi$GERCEKLESEN_URETIM), conf.level = 0.95)

```  

The output on the above is confidenece interval of the data. A point estimate for the true mean electrical energy generation  during the day is 434.5652 kwh, and we are 95% confident that the true mean is between  425.8012 kWh and 443.3291 kWh. The mean of the data is within the confidence interval we found. 


```{r}
harmandali.enerji.uretimi.CI <- t.test(harmandali.enerji.uretimi$GERCEKLESEN_URETIM)$conf.int
harmandali.enerji.uretimi.CI
``` 



# Hypothesis Testing 

### Dataset 1: 


#### Hypothesis 1: enerji.tuketimi.yolcubasina.IZMIR_METRO mean is different than 2 kWh, Ho:mu=2 Ha:mu < 2 kWh

```{r}
enerji.tuketimi.yolcubasina.t.test<- t.test(enerji.tuketimi.yolcubasina$IZMIR_METRO, alternative = c("two.sided"), mu = 2, conf.level = 0.95)
enerji.tuketimi.yolcubasina.t.test

```  
Result of t test is -7.9805. When p value is less than alpha, we reject the hypothesis. P-value ~ 0.006. That's mean p value is less than alpha(0.5) So, we reject h0 hypothesis.  

#### Hypothesis 2: enerji.tuketimi.yolcubasina.KARSIYAKA_TRAMVAYI mean is different than 1 kWh, Ho:mu = 1 Ha:mu < 1 kWh

Firstly, we need to find mean of enerji.tuketimi.yolcubasına$KARSIYAKA_TRAMVAYI

```{r}

mean(enerji.tuketimi.yolcubasina$KARSIYAKA_TRAMVAYI)

```

```{r}
enerji.tuketimi.yolcubasina.t.test2<- t.test(enerji.tuketimi.yolcubasina$KARSIYAKA_TRAMVAYI, alternative = c("two.sided"), mu = 1, conf.level = 0.95)
enerji.tuketimi.yolcubasina.t.test2

```
Result of t-test, p-value is less than alpha.(p-value~0.2) So, we reject the h0 hypothesis.

#### Hypothesis 3: enerji.tuketimi.yolcubasina.KONAK_TRAMVAYI mean is equal 1 kWh, Ho:mu = 1 Ha:mu < 1 kWh  

```{r}
mean(enerji.tuketimi.yolcubasina$KONAK_TRAMVAYI)



```  

```{r}
enerji.tuketimi.yolcubasina.t.test3<- t.test(enerji.tuketimi.yolcubasina$KONAK_TRAMVAYI, alternative = c("two.sided"), mu = 1, conf.level = 0.95, var.equal = TRUE, paired = F)
enerji.tuketimi.yolcubasina.t.test3

```
Result of this t test, we find a p-value as ~0.03.P value is less than alpha and we reject h0 hypothesis. Mean is not equal to 1.  



### Dataset 2: 


#### Hypothesis 1: enerji.tuketimi.cer.IZMIR_METRO mean is different than 2 kWh, Ho:mu=2 Ha:mu < 2 kWh

```{r}
mean(enerji.tuketimi.cer$IZMIR_METRO)

enerji.tuketimi.cer.t.test4<- t.test(enerji.tuketimi.cer$IZMIR_METRO, alternative = c("two.sided"), mu = 1, conf.level = 0.95)
enerji.tuketimi.cer.t.test4

```  
P value is less than alpha, we reject the hypothesis. P-value ~ 0.001. That's mean p value is less than alpha(0.05) So, we reject h0 hypothesis.  

#### Hypothesis 2: enerji.tuketimi.cer.KARSIYAKA_TRAMVAYI mean is different than 1 kWh, Ho:mu = 1 Ha:mu < 1 kWh


```{r}

mean(enerji.tuketimi.cer$KARSIYAKA_TRAMVAYI)

```

```{r}
enerji.tuketimi.cer.t.test5<- t.test(enerji.tuketimi.cer$KARSIYAKA_TRAMVAYI, alternative = c("two.sided"), mu = 4, conf.level = 0.95)
enerji.tuketimi.cer.t.test5

```
Result of t-test, p-value is less than alpha.(p-value~0.1) So, we reject the h0 hypothesis.

#### Hypothesis 3: enerji.tuketimi.cer.KONAK_TRAMVAYI mean is equal 1 kWh, Ho:mu = 1 Ha:mu < 1 kWh  

```{r}
mean(enerji.tuketimi.cer$KONAK_TRAMVAYI)



```  

```{r}
enerji.tuketimi.yolcubasina.t.test6<- t.test(enerji.tuketimi.yolcubasina$KONAK_TRAMVAYI, alternative = c("two.sided"), mu = 5, conf.level = 0.95, var.equal = TRUE, paired = F)
enerji.tuketimi.yolcubasina.t.test6

```
Result of this t test, we find a p-value as ~0.001.P value is less than alpha and we reject h0 hypothesis. Mean is not equal to 5.  

### Dataset 3: 


#### Hypothesis 1: harmandali.enerji.uretimi$PLANLANAN_URETIM mean is different than 2 kWh, Ho:mu=2 Ha:mu < 2 kWh

```{r}


harmandali.enerji.uretimi.t.test<- t.test(harmandali.enerji.uretimi$PLANLANAN_URETIM, alternative = c("two.sided"), mu = 400, conf.level = 0.95)
harmandali.enerji.uretimi.t.test

```  
P value is less than alpha, we reject the hypothesis. P-value ~ 0.002. That's mean p value is less than alpha(0.05) So, we reject h0 hypothesis.  



#### Hypothesis 2: harmandali.enerji.uretimi$GERCEKLESEN_URETIM mean is equal 1 kWh, Ho:mu = 1 Ha:mu < 1 kWh  



```{r}

harmandali.enerji.uretimi.t.test2<- t.test(harmandali.enerji.uretimi$GERCEKLESEN_URETIM, alternative = c("two.sided"), mu = 400, conf.level = 0.95)
harmandali.enerji.uretimi.t.test2



```
Result of this t test, we find a p-value as ~0.0. P value is less than alpha and we reject h0 hypothesis.

### Bonus
The datas I have chosen are not suitable for the two-sample t-test. That's why I'm going to use the dataset included with R. 

```{r}
Iris <- read.csv("C:/Users/gulde/Downloads/Iris.csv")
head(Iris)
```  
#### Hypothesis: The mean sepal width for the Versicolor species is estimated to be less than for the Virginica species. 

```{r}


iris.t.test <- t.test(SepalLengthCm~ Species, Iris, Species %in% c("Iris-versicolor", "Iris-virginica"), var.equal = T)
iris.t.test




```

The p-value  is less than the significance level of so we can reject the null hypothesis.  

#### Data Normality:

```{r}

with(Iris, qqnorm(SepalLengthCm[Species=="Iris-versicolor"]))
with(Iris, qqline(SepalLengthCm[Species=="Iris-versicolor"], col = "red"))

```  
In this data the points to close to lying on a straight line. So we can say Iris data is normal.




# Anova/Regression

  
####  Dataset 1: H0: There is no difference between the means. (ANOVA)
```{r}
stations <- c(rep("KARSIYAKA_TRAMVAYI", 12),rep("IZMIR_METROSU", 12), rep("KONAK_TRAMVAYI", 12))


energy_consumption <- c(enerji.tuketimi.yolcubasina$KARSIYAKA_TRAMVAYI, enerji.tuketimi.yolcubasina$IZMIR_METRO, enerji.tuketimi.yolcubasina$KONAK_TRAMVAYI)

dataFrame <- data.frame(stations, energy_consumption)
dataFrame
summary(dataFrame)


```  
```{r}
Anova <- aov(energy_consumption ~ stations, data = dataFrame)
summary(Anova)
```  
In the table above p value(~0.08) is grater than significance level. So, we reject the null. There is not enough evidence to suggest different means between groups.

### Dataset 2: H0: There is no difference between the means. (ANOVA)

```{r}
stations2 <- c(rep("KARSIYAKA_TRAMVAYI", 12),rep("IZMIR_METROSU", 12), rep("KONAK_TRAMVAYI", 12))


energy_consumption2 <- c(enerji.tuketimi.cer$KARSIYAKA_TRAMVAYI, enerji.tuketimi.cer$IZMIR_METRO, enerji.tuketimi.cer$KONAK_TRAMVAYI)

dataFrame2 <- data.frame(stations, energy_consumption)
dataFrame2
summary(dataFrame2)


```  
```{r}
Anova2 <- aov(energy_consumption2 ~ stations2, data = dataFrame2)
summary(Anova2)
```  

```  
In the table above, p value is close to zero and less than .05. So, h0 is rejected.


###  Dataset 3: For Regression
```{r}
library(caTools)
set.seed(123)
split = sample.split(harmandali.enerji.uretimi$GERCEKLESEN_URETIM, SplitRatio = 2/3)
training_set = subset(harmandali.enerji.uretimi, split==TRUE)
test_set = subset(harmandali.enerji.uretimi, split == FALSE)
training_set
test_set

```

In the above table, we determined a random variable for sampling and split the datas as True or False. 

```{r}
reg <- lm(formula = GERCEKLESEN_URETIM ~ PLANLANAN_URETIM, data= training_set)
summary(reg)


```  
It is aimed to establish a model that predicts the actual production according to the planned production above. We use the regression model for this, because there are dependent and independent variable.  As seen in the table above, the p value(0.04) is less than .05. This means that the model is normal and we can use this model.  

```{r}
ggplot2::ggplot()+
 ggplot2::geom_point(ggplot2::aes(x = training_set$PLANLANAN_URETIM, y = training_set$GERCEKLESEN_URETIM), color='red') + ggplot2::geom_line(ggplot2::aes(x = training_set$PLANLANAN_URETIM, y = predict(reg, newdata = training_set)),
 color = 'blue')+
 ggplot2::ggtitle('Regression Graph for Actual Production forecast Relative to Planned Production  ')

```  
When we look at the graph, although we cannot say that all points extend to the length of the line, we can say that enough points extend to the line. 


# References  
-González-Rodríguez, Gil, Ana Colubi, and María Ángeles Gil. "Fuzzy data treated as functional data: A one-way ANOVA test approach." Computational Statistics & Data Analysis 56.4 (2012): 943-955.
-Dr.Zeynep Filiz EREN DOGU, CENG 3516 STATISTICAL COMPUTING "Lecture 6 - Confidence Intervals and Hypothesis testing in R." Mar 10, 2021






